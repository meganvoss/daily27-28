[
  {
    "objectID": "daily27-28.html",
    "href": "daily27-28.html",
    "title": "daily27-28",
    "section": "",
    "text": "library(sf)\n\nLinking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(terra)\n\nterra 1.8.42\n\nlibrary(osmdata)\n\nData (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:terra':\n\n    intersect, union\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\n\nbbox &lt;- getbb(\"Fort Collins, Colorado\")\nwaterways &lt;- opq(bbox) %&gt;%\n  add_osm_feature(key = \"waterway\") %&gt;%\n  osmdata_sf()\n\npoudre_river &lt;- waterways$osm_lines %&gt;%\n  filter(grepl(\"Cache la Poudre\", name)) %&gt;%\n  st_union() %&gt;%\n  st_as_sf()\n\nriver_length &lt;- st_length(poudre_river)\n\npoudre_pts &lt;- st_cast(poudre_river, \"POINT\")\n\n\nlibrary(terra)\n\nSys.setenv(\"AWS_NO_SIGN_REQUEST\" = \"YES\")\n\ndem &lt;- rast(\"/vsis3/lynker-spatial/gridded-resources/dem.vrt\")\n\n\npoudre_river_proj &lt;- st_transform(poudre_river, crs(dem))\n\ndem_crop &lt;- crop(dem, poudre_river_proj)\n\nelev_vals &lt;- extract(dem_crop, poudre_pts)\n\nWarning: [extract] transforming vector data to the CRS of the raster\n\n\n\nriver_profile &lt;- bind_cols(poudre_pts, elev_vals) %&gt;%\n  mutate(ID = row_number())\n\n\nlibrary(ggplot2)\n\nggplot(river_profile, aes(x = ID, y = dem)) +\n  geom_line(color = \"blue\", linewidth = 1.2) +\n  labs(\n    title = \"Elevation Profile of Cache la Poudre River\",\n    x = \"Point along river\",\n    y = \"Elevation (cm)\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\ninlet &lt;- head(poudre_pts, 1)\noutlet &lt;- tail(poudre_pts, 1)\n\nline &lt;- st_union(inlet, outlet) |&gt; st_cast(\"LINESTRING\")\n\nstraight_dist &lt;- st_length(line)\nriver_len &lt;- st_length(poudre_river_proj)\n\nsinuosity &lt;- as.numeric(river_len / straight_dist)\n\n\nend_pts &lt;- rbind(inlet, outlet)\n\nelev_ends &lt;- extract(dem_crop, end_pts)\n\nWarning: [extract] transforming vector data to the CRS of the raster\n\n\n\nelev_diff &lt;- elev_ends$dem[1] - elev_ends$dem[2]\n\nriver_len_meters &lt;- units::drop_units(river_len) / 100  # cm to meters\n\nslope_percent &lt;- 100 * elev_diff / river_len_meters\nslope_percent\n\n[1] 9961.666\n\n\n\nggplot(river_profile) +\n  geom_sf(aes(color = dem), size = 1) +\n  scale_color_viridis_c(option = \"plasma\") +\n  labs(\n    title = \"Cache la Poudre River Colored by Elevation\",\n    color = \"Elevation (cm)\"\n  ) +\n  theme_minimal()"
  }
]